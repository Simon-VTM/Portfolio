<!doctype html>
<html lang="da">
<head>
  <meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
  <title>4. semester – Graff’s Hus, Esbjerg</title>
  <style>
    :root{ --space:20px; --radius:16px; --border:#e6e8eb; }
    body{ font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial; margin:0; color:#0f172a; background:#f8fafc }
    header, main{ max-width:1000px; margin:0 auto; padding:24px } a{ color:#1f2937 }
    .back{ display:inline-block; margin:8px 0 16px; text-decoration:none }
    .hero{ border-radius:var(--radius); overflow:hidden; background:#fff }
    .media{ aspect-ratio:16/9; background:linear-gradient(180deg,#f1f5f9,#fff); display:flex; align-items:center; justify-content:center; }
    .media img{ width:100%; height:100%; object-fit:contain; display:block; background:#fff; }
    .body{ padding:var(--space); background:#fff }
    .meta{ color:#000; font-size:18px; font-weight:600; margin-bottom:8px }
    h1{ margin:0 0 8px; font-size:28px }
    .grid{ display:grid; gap:var(--space); grid-template-columns:1fr } 
    @media(min-width:900px){ .grid{ grid-template-columns:2fr 1fr } }
    section{ background:#fff; padding:var(--space); border-radius:var(--radius) }
    .chips{ display:flex; gap:8px; flex-wrap:wrap; margin-top:12px } 
    .chip{ padding:6px 10px; border-radius:999px; background:#eef2f7; font-size:12px }
    footer{ text-align:center; padding:40px 24px; color:#475569 }

    main.grid{ display:grid; gap:20px; grid-template-columns: 2fr 1fr; }
    @media (max-width:900px){ main.grid{ grid-template-columns:1fr; } }

    .card{ background:#fff; padding:var(--space); border-radius:var(--radius); }
    .full-span{ grid-column: 1 / -1; }

    /* Galleri */
    .gallery-section h2{ margin:0 0 10px; }
    .gallery-section h3{ margin:18px 0 10px; font-size:18px; }
    .gallery-grid{ display:grid; gap:12px; grid-template-columns:repeat(auto-fill,minmax(220px,1fr)); }
    .gallery-grid button{ 
      display:block; border:1px solid var(--border); border-radius:12px; overflow:hidden; 
      background:#fff; text-decoration:none; color:inherit; cursor:pointer; padding:0;
      transition: transform 0.2s ease;
    }
    .gallery-grid button:hover{ transform: translateY(-2px); box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
    .gallery-grid img{ width:100%; aspect-ratio:4/3; object-fit:cover; display:block; transition:transform .15s; }
    .gallery-grid button:hover img{ transform:scale(1.02); }

    /* Modal (identisk med 2. semester) */
    .modal-overlay{ 
      position:fixed; top:0; left:0; width:100vw; height:100vh; 
      background:rgba(0,0,0,0.9); z-index:1000; display:none;
      backdrop-filter: blur(10px);
    }
    .modal-overlay.active{ display:flex; align-items:center; justify-content:center; }
    
    .modal-content{ 
      position:relative; width:100vw; height:100vh; 
      display:flex; align-items:center; justify-content:center;
      touch-action: pan-x pan-y pinch-zoom;
      overflow: hidden;
    }
    
    .modal-image{ 
      max-width:100%; max-height:calc(100vh - 80px); object-fit:contain; 
      transition: transform 0.3s ease;
      transform-origin: center center;
      cursor: grab;
      margin-top: 40px;
    }
    
    .modal-image:active{ cursor: grabbing; }

    .modal-nav{ 
      position:absolute; top:50%; transform:translateY(-50%); z-index:15;
      background:rgba(255,255,255,0.2); border:2px solid rgba(255,255,255,0.3); border-radius:50%; 
      width:54px; height:54px; font-size:24px; cursor:pointer; color:white;
      backdrop-filter: blur(10px); transition: all 0.2s ease;
      display:flex; align-items:center; justify-content:center;
    }
    .modal-nav:hover{ background:rgba(255,255,255,0.3); transform:translateY(-50%) scale(1.1); }
    .modal-nav.prev{ left:30px; }
    .modal-nav.next{ right:30px; }
    
    .modal-close{ 
      position:absolute; top:20px; right:20px; z-index:20;
      background:rgba(255,255,255,0.2); border:2px solid rgba(255,255,255,0.3); border-radius:50%; 
      width:44px; height:44px; font-size:24px; cursor:pointer; color:white;
      backdrop-filter: blur(10px); transition: all 0.2s ease;
      display:flex; align-items:center; justify-content:center;
    }
    .modal-close:hover{ background:rgba(255,255,255,0.3); transform: scale(1.1); }

    .modal-counter{ 
      position:absolute; bottom:20px; left:50%; transform:translateX(-50%);
      background:rgba(0,0,0,0.7); color:white; padding:8px 16px; 
      border-radius:20px; font-size:14px; backdrop-filter: blur(10px);
    }

    .modal-title{ 
      position:absolute; top:0; left:0; right:0; z-index:10;
      background:linear-gradient(180deg, rgba(0,0,0,0.8) 0%, rgba(0,0,0,0.4) 70%, transparent 100%); 
      color:white; padding:20px; font-size:16px; font-weight:500;
      backdrop-filter: blur(10px);
    }

    @media (max-width: 768px) {
      .modal-nav{ width:44px; height:44px; font-size:20px; }
      .modal-nav.prev{ left:15px; }
      .modal-nav.next{ right:15px; }
      .modal-title{ padding:15px; font-size:14px; }
      .modal-image{ max-height:calc(100vh - 60px); margin-top: 30px; }
    }
  </style>
</head>
<body>
<header>
  <a class="back" href="projekter.html">← Tilbage til projekter</a>
  <div class="hero">
    <div class="media">
      <img src="billeder/4-semester.jpg" alt="Visualisering – 4 semester"
            loading="lazy" 
            style="width:100%;height:100%;object-fit:contain;object-position:50% 50%;display:block;background:#fff;">
    </div>
    <div class="body">
      <div class="meta">4. semester • Randbebyggelse</div>
      <h1>Graff’s Hus – Esbjerg</h1>
      <div class="chips"><span class="chip">BR18</span><span class="chip">DGNB</span><span class="chip">Ventilation</span><span class="chip">Brand</span><span class="chip">Energi</span></div>
    </div>
  </div>
</header>

<main class="grid">
  <!-- Venstre kort -->
  <section class="card">
    <h2 style="margin-top:0;">Projektoversigt</h2>
    <p>På fjerde semester blev dispositionsforslaget til Graff’s Hus i Esbjerg
    videreudviklet til forslag-, myndigheds- og udbudsprojekt. Randbebyggelse i fire
    etager med kælder, indeholdende butikker, restaurant, kontorer og boliger.
    Der blev projekteret efter BR18 og DGNB med fokus på bæredygtige materialer og
    konstruktioner. Særligt fokus lå på ventilation (dimensionering, placering og
    kanalføring) samt koordinering med øvrige installationer.</p>

    <h3>Nøgleopgaver</h3>
    <ul>
      <li>Videreudvikling fra dispositionsforslag til myndighed og udbud</li>
      <li>BR18-overholdelse og DGNB-krav</li>
      <li>Ventilationsprojektering og installationskoordination</li>
      <li>Hoved- og detailtegninger</li>
      <li>Statiske beregninger og energiberegning</li>
      <li>Brandstrategi, arbejdsmiljøplan og bygningsdelsbeskrivelser</li>
    </ul>
  </section>

  <!-- Højre kort -->
  <section class="card">
    <h2 style="margin-top:0;">Fakta</h2>
    <ul>
      <li><strong>Type:</strong> Randbebyggelse i 4 etager m. kælder (erhverv + boliger)</li>
      <li><strong>Fokus:</strong> BR18, DGNB, bæredygtige valg, ventilation/teknik</li>
      <li><strong>Roller/værktøjer:</strong> Revit, energiramme, statik, brand</li>
    </ul>
  </section>

  <!-- Galleri med modal -->
  <section class="card gallery-section full-span" id="galleri">
    <h2>Galleri</h2>

    <h3>Plan-tegninger</h3>
    <div class="gallery-grid">
      <button type="button" data-src="billeder/4-semester/plan-01.jpg" data-title="Plan – Graff’s Hus">
        <img src="billeder/4-semester/plan-01.jpg" alt="Plan – Graff’s Hus" loading="lazy">
      </button>
      <button type="button" data-src="billeder/4-semester/snit-01.jpg" data-title="Snit – Graff’s Hus">
        <img src="billeder/4-semester/snit-01.jpg" alt="Snit – Graff’s Hus" loading="lazy">
      </button>
    </div>

    <h3>Facade- og Snit-tegninger</h3>
    <div class="gallery-grid">
      <button type="button" data-src="billeder/4-semester/plan-01.jpg" data-title="Plan – Graff’s Hus">
        <img src="billeder/4-semester/plan-01.jpg" alt="Plan – Graff’s Hus" loading="lazy">
      </button>
      <button type="button" data-src="billeder/4-semester/snit-01.jpg" data-title="Snit – Graff’s Hus">
        <img src="billeder/4-semester/snit-01.jpg" alt="Snit – Graff’s Hus" loading="lazy">
      </button>
    </div>

    <h3>Tekniske-tegninger</h3>
    <div class="gallery-grid">
      <button type="button" data-src="billeder/4-semester/K08_H5_E02_N01_Detalje Brandtætning omkring ventilationsrør.jpg" data-title="Detalje – Brandtætning">
        <img src="billeder/4-semester/K08_H5_E02_N01_Detalje Brandtætning omkring ventilationsrør.jpg" alt="Detalje – Brandtætning" loading="lazy">
      </button>
      <button type="button" data-src="billeder/4-semester/K08_H5_E0L_N02_Gulvopbygning Ventilationsaggregat Detalje.jpg" data-title="Detalje – Aggregat">
        <img src="billeder/4-semester/K08_H5_E0L_N02_Gulvopbygning Ventilationsaggregat Detalje.jpg" alt="Detalje – Aggregat" loading="lazy">
      </button>
      <button type="button" data-src="billeder/4-semester/K08_H0_E0X_N01_Oversigt - Ventilationsføring MEP.jpg" data-title="Ventilation oversigt">
        <img src="billeder/4-semester/K08_H0_E0X_N01_Oversigt - Ventilationsføring MEP.jpg" alt="Ventilation oversigt" loading="lazy">
      </button>
      <button type="button" data-src="billeder/4-semester/K08_H1_E01_N04_1.sal -  Ventilationsføring MEP.jpg" data-title="Ventilation 1.sal">
        <img src="billeder/4-semester/K08_H1_E01_N04_1.sal -  Ventilationsføring MEP.jpg" alt="Ventilation 1.sal" loading="lazy">
      </button>
      <button type="button" data-src="billeder/4-semester/K08_H1_EST_N03_Stueplan - Ventilationsføring MEP.jpg" data-title="Ventilation stueplan">
        <img src="billeder/4-semester/K08_H1_EST_N03_Stueplan - Ventilationsføring MEP.jpg" alt="Ventilation stueplan" loading="lazy">
      </button>
    </div>

    <h3>Visualiseringer</h3>
    <div class="gallery-grid">
      <button type="button" data-src="billeder/4-semester/vis-01.jpg" data-title="Visualisering – hjørne">
        <img src="billeder/4-semester/vis-01.jpg" alt="Visualisering – hjørne" loading="lazy">
      </button>
      <button type="button" data-src="billeder/4-semester/vis-02.jpg" data-title="Visualisering – gade">
        <img src="billeder/4-semester/vis-02.jpg" alt="Visualisering – gade" loading="lazy">
      </button>
    </div>
  </section>
</main>

<!-- Modal (samme markup som 2. semester) -->
<div class="modal-overlay" id="modalOverlay">
  <div class="modal-content">
    <img class="modal-image" id="modalImage" src="" alt="">
    <button class="modal-nav prev" id="prevBtn">‹</button>
    <button class="modal-nav next" id="nextBtn">›</button>
    <button class="modal-close" id="closeBtn">×</button>
    <div class="modal-counter" id="modalCounter">1 / 1</div>
    <div class="modal-title" id="modalTitle">Image Title</div>
  </div>
</div>

<footer>© 2025 Simon Vad Møller</footer>

<script>
  class SwipeableGallery {
    constructor() {
      this.currentIndex = 0;
      this.images = [];
      this.touchStartX = 0;
      this.touchEndX = 0;
      this.touchStartY = 0;
      this.touchEndY = 0;
      this.scale = 1;
      this.translateX = 0;
      this.translateY = 0;
      this.isDragging = false;
      this.lastPinchDistance = 0;
      
      this.modal = document.getElementById('modalOverlay');
      this.modalImage = document.getElementById('modalImage');
      this.prevBtn = document.getElementById('prevBtn');
      this.nextBtn = document.getElementById('nextBtn');
      this.closeBtn = document.getElementById('closeBtn');
      this.counter = document.getElementById('modalCounter');
      this.title = document.getElementById('modalTitle');
      
      this.initEventListeners();
    }
    
    initEventListeners() {
      // Hent ALLE billeder på siden
      document.querySelectorAll('[data-src]').forEach((btn, index) => {
        btn.addEventListener('click', () => {
          this.openModal(index);
        });
      });
      
      // Modal controls
      this.prevBtn.addEventListener('click', () => this.showPrevious());
      this.nextBtn.addEventListener('click', () => this.showNext());
      this.closeBtn.addEventListener('click', () => this.closeModal());
      
      // Keyboard navigation
      document.addEventListener('keydown', (e) => {
        if (!this.modal.classList.contains('active')) return;
        switch(e.key) {
          case 'ArrowLeft': this.showPrevious(); break;
          case 'ArrowRight': this.showNext(); break;
          case 'Escape': this.closeModal(); break;
        }
      });
      
      // Touch/swipe events
      this.modal.addEventListener('touchstart', (e) => {
        if (e.touches.length === 1) {
          this.touchStartX = e.touches[0].clientX;
          this.touchStartY = e.touches[0].clientY;
          this.isDragging = true;
        } else if (e.touches.length === 2) {
          this.lastPinchDistance = this.getPinchDistance(e.touches);
        }
      });
      
      this.modal.addEventListener('touchmove', (e) => {
        if (e.touches.length === 1 && this.isDragging && this.scale > 1) {
          e.preventDefault();
          const deltaX = e.touches[0].clientX - this.touchStartX;
          const deltaY = e.touches[0].clientY - this.touchStartY;
          this.translateX += deltaX;
          this.translateY += deltaY;
          this.updateImageTransform();
          this.touchStartX = e.touches[0].clientX;
          this.touchStartY = e.touches[0].clientY;
        } else if (e.touches.length === 2) {
          e.preventDefault();
          const pinchDistance = this.getPinchDistance(e.touches);
          const scaleChange = pinchDistance / this.lastPinchDistance;
          this.scale = Math.min(Math.max(this.scale * scaleChange, 0.5), 3);
          if (this.scale <= 1) {
            this.scale = 1;
            this.translateX = 0;
            this.translateY = 0;
          }
          this.updateImageTransform();
          this.lastPinchDistance = pinchDistance;
        }
      });
      
      this.modal.addEventListener('touchend', (e) => {
        if (e.touches.length === 0) {
          this.touchEndX = e.changedTouches[0].clientX;
          this.touchEndY = e.changedTouches[0].clientY;
          this.isDragging = false;
          if (this.scale === 1) this.handleSwipe();
        }
      });
      
      // Mouse wheel zoom
      this.modal.addEventListener('wheel', (e) => {
        e.preventDefault();
        const zoomFactor = e.deltaY > 0 ? 0.9 : 1.1;
        this.scale = Math.min(Math.max(this.scale * zoomFactor, 0.5), 3);
        if (this.scale <= 1) {
          this.scale = 1;
          this.translateX = 0;
          this.translateY = 0;
        }
        this.updateImageTransform();
      });
      
      // Mouse drag (desktop)
      this.modalImage.addEventListener('mousedown', (e) => {
        if (this.scale > 1) {
          this.isDragging = true;
          this.touchStartX = e.clientX;
          this.touchStartY = e.clientY;
          e.preventDefault();
        }
      });
      
      document.addEventListener('mousemove', (e) => {
        if (this.isDragging && this.scale > 1) {
          const deltaX = e.clientX - this.touchStartX;
          const deltaY = e.clientY - this.touchStartY;
          this.translateX += deltaX;
          this.translateY += deltaY;
          this.updateImageTransform();
          this.touchStartX = e.clientX;
          this.touchStartY = e.clientY;
        }
      });
      
      document.addEventListener('mouseup', () => {
        this.isDragging = false;
      });
      
      // Double-click to reset
      this.modalImage.addEventListener('dblclick', () => {
        this.scale = 1;
        this.translateX = 0;
        this.translateY = 0;
        this.updateImageTransform();
      });
      
      // Click outside to close
      this.modal.addEventListener('click', (e) => {
        if (e.target === this.modal || e.target.classList.contains('modal-content')) {
          this.closeModal();
        }
      });
    }
    
    openModal(clickedIndex) {
      this.images = Array.from(document.querySelectorAll('[data-src]'));
      this.currentIndex = clickedIndex;
      this.scale = 1;
      this.translateX = 0;
      this.translateY = 0;
      this.showImage();
      this.modal.classList.add('active');
      document.body.style.overflow = 'hidden';
    }
    
    closeModal() {
      this.modal.classList.remove('active');
      document.body.style.overflow = '';
    }
    
    showPrevious() {
      this.currentIndex = (this.currentIndex - 1 + this.images.length) % this.images.length;
      this.scale = 1; this.translateX = 0; this.translateY = 0;
      this.showImage();
    }
    
    showNext() {
      this.currentIndex = (this.currentIndex + 1) % this.images.length;
      this.scale = 1; this.translateX = 0; this.translateY = 0;
      this.showImage();
    }
    
    showImage() {
      const currentImage = this.images[this.currentIndex];
      this.modalImage.src = currentImage.dataset.src;
      this.modalImage.alt = currentImage.dataset.title || '';
      this.title.textContent = currentImage.dataset.title || '';
      this.counter.textContent = `${this.currentIndex + 1} / ${this.images.length}`;
      this.updateImageTransform();
      this.prevBtn.style.display = this.images.length > 1 ? 'flex' : 'none';
      this.nextBtn.style.display = this.images.length > 1 ? 'flex' : 'none';
    }
    
    updateImageTransform() {
      if (this.scale === 1 && (this.translateX !== 0 || this.translateY !== 0)) {
        this.modalImage.style.transition = 'transform 0.3s ease';
      } else {
        this.modalImage.style.transition = 'transform 0.1s ease';
      }
      this.modalImage.style.transform = `translate(${this.translateX}px, ${this.translateY}px) scale(${this.scale})`;
      if (this.scale === 1) {
        setTimeout(() => { this.modalImage.style.transition = 'transform 0.1s ease'; }, 300);
      }
    }
    
    getPinchDistance(touches) {
      const dx = touches[0].clientX - touches[1].clientX;
      const dy = touches[0].clientY - touches[1].clientY;
      return Math.sqrt(dx * dx + dy * dy);
    }
    
    handleSwipe() {
      const swipeThreshold = 50;
      const swipeDistance = this.touchEndX - this.touchStartX;
      const swipeDistanceY = Math.abs(this.touchEndY - this.touchStartY);
      if (Math.abs(swipeDistance) > swipeThreshold && swipeDistanceY < 100 && this.scale === 1) {
        if (swipeDistance > 0) this.showPrevious(); else this.showNext();
      }
    }
  }
  
  document.addEventListener('DOMContentLoaded', () => {
    new SwipeableGallery();
  });
</script>
</body>
</html>
